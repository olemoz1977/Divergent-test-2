<!doctype html>
<html lang="lt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Divirgent Test V2.1 – OCEAN (LT)</title>
  <meta name="description" content="Divirgent Test V2.1 – Big Five (OCEAN) vieno failo testas: 60 teiginių, rezultatai naršyklėje, TOP‑3 stiprybės ir augimo sritys su rekomendacijomis, tipų artimumas." />
  <meta name="color-scheme" content="dark light" />
  <style>
    /* ===========================
       Divirgent Test – vieno failo stiliai
       Versija: 2.1
       =========================== */
    :root{--c0:#0ea5e9;--c1:#22c55e;--c2:#f59e0b;--c3:#a78bfa;--c4:#ef4444;--bg:#0b1320;--fg:#e5e7eb;--muted:#9ca3af;--panel:#0f172a;--line:#1f2937}
    html,body{height:100%}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;line-height:1.45;margin:0;background:var(--bg);color:var(--fg)}
    .wrap{max-width:980px;margin:24px auto;padding:16px}
    h1,h2,h3{margin:0.6em 0}
    .topbar{position:sticky;top:0;background:rgba(11,19,32,0.85);backdrop-filter:saturate(1.2) blur(6px);padding:10px 0;border-bottom:1px solid var(--line);z-index:10}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
    button, .btn{background:#111827;color:var(--fg);border:1px solid #334155;border-radius:8px;padding:10px 14px;cursor:pointer;text-decoration:none}
    button:hover,.btn:hover{background:#0f172a}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    .card{border:1px solid var(--line);border-radius:12px;padding:14px;background:var(--panel)}
    .domain{font-weight:600}
    .item{padding:12px;border:1px dashed var(--line);border-radius:10px;background:rgba(11,19,32,0.6)}
    .scale{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:6px}
    .scale label{display:flex;flex-direction:column;align-items:center;font-size:12px;color:#cbd5e1}
    .scale input{accent-color:#22c55e;cursor:pointer}
    .progress{height:10px;background:#111827;border-radius:999px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,var(--c0),var(--c1),var(--c2));width:0%}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border-bottom:1px solid var(--line);padding:8px;text-align:left}
    .mono{font-variant-numeric:tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;}
    .pill{display:inline-block;padding:.2em .6em;border:1px solid var(--line);border-radius:999px;margin:.15em .25em;background:rgba(11,19,32,0.6)}
    .kudos{font-size:12px;color:#94a3b8;margin-top:16px}
    .domain-tag{display:inline-block;min-width:28px;text-align:center;padding:.1em .5em;border-radius:999px;border:1px solid var(--line);margin-right:.5em}
    .O{background:#072538;border-color:#0ea5e940}
    .C{background:#072a1f;border-color:#22c55e40}
    .E{background:#2a1d07;border-color:#f59e0b40}
    .A{background:#201b2e;border-color:#a78bfa40}
    .N{background:#2a1111;border-color:#ef444440}
    .inline-note{font-size:12px;color:#a1a1aa}
    .flex{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .right{margin-left:auto}
    .danger{border-color:#7f1d1d}
    .ok{border-color:#14532d}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    @media(min-width:900px){
      .grid{grid-template-columns: 1fr 1fr}
    }

    /* Spausdinimui – šviesus fonas ir juodas tekstas */
    @media print {
      :root{--bg:#ffffff;--fg:#000000;--panel:#ffffff;--line:#e5e7eb}
      body{background:#fff;color:#000}
      .topbar{position:static;background:#fff;border-bottom:1px solid #e5e7eb}
      button, .btn, .actions a{display:none!important}
      .item{background:#fff;border-color:#e5e7eb}
      .kudos{color:#555}
      .progress{display:none}
      a[href]:after{content:" (" attr(href) ")"; font-size:11px}
    }
  </style>
</head>
<body>
  <!-- Viršus: sticky navigacija ir veiksmai -->
  <div class="topbar">
    <div class="wrap">
      <div class="flex">
        <div><strong>Divirgent Test V2.1 – OCEAN (LT)</strong></div>
        <span class="inline-note"> ~8–10 min · 60 teiginių · be prisijungimo · skaičiuojama naršyklėje</span>
        <span class="right inline-note">PDF: naudok naršyklės „Išsaugoti kaip PDF“</span>
      </div>
      <div class="actions">
        #teiginiaiPereiti prie teiginių</a>
        <button id="calcBtn" type="button">Gauti rezultatą</button>
        <button id="clearBtn" type="button">Išvalyti</button>
      </div>
    </div>
  </div>

  <!-- Įžanga -->
  <main class="wrap" id="intro">
    <h1>Divirgent Test V2.1 – OCEAN (LT)</h1>
    <p class="muted">Likertas: 1 – Visiškai nesutinku · 5 – Visiškai sutinku. Invertuoti teiginiai skaičiuojami priešingai.</p>
    <noscript><p style="color:#ef4444"><strong>Šiam testui reikia JavaScript.</strong> Įjunkite JavaScript naršyklėje.</p></noscript>
  </main>

  <!-- Teiginiai (dinamiškai sugeneruojami) -->
  <section class="wrap" id="teiginiai" aria-labelledby="hdr-teiginiai">
    <h2 id="hdr-teiginiai">Teiginiai</h2>
    <div id="itemsHost" class="grid" role="group" aria-describedby="likertHelp"></div>
    <p id="likertHelp" class="sr-only">Kiekvienam teiginiui pasirinkite atsakymą skalėje nuo 1 iki 5.</p>
  </section>

  <!-- Rezultatai -->
  <section class="wrap" id="results" aria-labelledby="hdr-rezultatai">
    <h2 id="hdr-rezultatai">Rezultatai</h2>
    <p id="fillAllNote" class="muted">Užpildykite visus teiginius ir paspauskite „Gauti rezultatą“.</p>

    <div class="grid">
      <div class="card">
        <h3>Lentelė</h3>
        <div class="progress" title="Bendras užpildymo progresas">
          <div class="bar" id="progressBar" style="width:0%"></div>
        </div>
        <table id="resTable">
          <thead>
            <tr>
              <th>Domenas</th>
              <th>Vidurkis (1–5)</th>
              <th>Normalizuota (–1…+1)</th>
              <th>%</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="card">
        <h3>TOP‑3 stiprybės (OCEAN)</h3>
        <div id="strengths"></div>
        <h3>TOP‑3 augimo sritys</h3>
        <div id="growth"></div>
        <h3>Tipų artimumas (TOP‑3)</h3>
        <div id="typesTop"></div>
      </div>
    </div>

    <div class="kudos">© 2025 Divirgent Test · Vieno failo versija (index.html)</div>
  </section>

  <!-- ===========================
       JavaScript logika
       =========================== -->
  <script>
  /* ====== 1) Modelis: domenai, teiginiai, tipai, rekomendacijos ====== */
  const DOMAINS = {
    O: { name: "Atvirumas (O)", color: "O" },
    C: { name: "Pareigingumas (C)", color: "C" },
    E: { name: "Ekstravertiškumas (E)", color: "E" },
    A: { name: "Sutariamumas (A)", color: "A" },
    N: { name: "Neurotiškumas (N)", color: "N" }
  };

  /* 60 teiginių (12×5). invert: true reiškia atvirkštinis skaičiavimas. */
  const ITEMS = [
    /* O: Atvirumas (12) */
    {id:"O1", d:"O", t:"Mėgstu tyrinėti naujas idėjas ir koncepcijas.", invert:false},
    {id:"O2", d:"O", t:"Dažnai svajoju ir įsivaizduoju galimus scenarijus.", invert:false},
    {id:"O3", d:"O", t:"Mėgstu meno, muzikos ar literatūros įvairovę.", invert:false},
    {id:"O4", d:"O", t:"Rutina man teikia daugiau saugumo nei naujovės.", invert:true},
    {id:"O5", d:"O", t:"Greitai perprantu abstrakčias idėjas.", invert:false},
    {id:"O6", d:"O", t:"Vengiu netikrumo ir neapibrėžtumo.", invert:true},
    {id:"O7", d:"O", t:"Smalsiai bandau naujus metodus ar įrankius.", invert:false},
    {id:"O8", d:"O", t:"Man labiau patinka pažįstami maršrutai ir vietos.", invert:true},
    {id:"O9", d:"O", t:"Lengvai prisitaikau prie pokyčių.", invert:false},
    {id:"O10", d:"O", t:"Nejaučiu poreikio mokytis dalykų už mano srities ribų.", invert:true},
    {id:"O11", d:"O", t:"Kūrybinės užduotys mane įkvepia.", invert:false},
    {id:"O12", d:"O", t:"Nedžiugina nauji skoniai, žanrai ar stiliai.", invert:true},

    /* C: Pareigingumas (12) */
    {id:"C1", d:"C", t:"Tvarką ir planą laikau svarbiais kasdien.", invert:false},
    {id:"C2", d:"C", t:"Dažnai atidėlioju svarbias užduotis.", invert:true},
    {id:"C3", d:"C", t:"Laikausi terminų ir įsipareigojimų.", invert:false},
    {id:"C4", d:"C", t:"Mano darbo vieta dažniausiai netvarkinga.", invert:true},
    {id:"C5", d:"C", t:"Dirbu nuosekliai ir sistemiškai.", invert:false},
    {id:"C6", d:"C", t:"Smulkmenos man neretai „praslysta pro akis“.", invert:true},
    {id:"C7", d:"C", t:"Užbaigiu tai, ką pradedu.", invert:false},
    {id:"C8", d:"C", t:"Mėgstu veikti spontaniškai, be plano.", invert:true},
    {id:"C9", d:"C", t:"Lengvai laikau prioritetus esant dideliam krūviui.", invert:false},
    {id:"C10", d:"C", t:"Dažnai pametu gijas arba praleidžiu svarbią smulkmeną.", invert:true},
    {id:"C11", d:"C", t:"Esu patikimas(-a) ir atsakingas(-a).", invert:false},
    {id:"C12", d:"C", t:"Taisyklės dažniausiai trukdo ir jas apeinu.", invert:true},

    /* E: Ekstravertiškumas (12) */
    {id:"E1", d:"E", t:"Pradėti pokalbį su nepažįstamais man lengva.", invert:false},
    {id:"E2", d:"E", t:"Didelės žmonių grupės mane vargina.", invert:true},
    {id:"E3", d:"E", t:"Mėgstu būti dėmesio centre.", invert:false},
    {id:"E4", d:"E", t:"Greičiau renkuosi vienatvę, nei šurmulį.", invert:true},
    {id:"E5", d:"E", t:"Esu energingas(-a) ir gyvas(-a) bendraujant.", invert:false},
    {id:"E6", d:"E", t:"Esu santūrus(-i) ir mažai kalbus(-i).", invert:true},
    {id:"E7", d:"E", t:"Greitai užmezgu ryšį su žmonėmis.", invert:false},
    {id:"E8", d:"E", t:"Retai imuosi iniciatyvos socialinėse situacijose.", invert:true},
    {id:"E9", d:"E", t:"Man patinka komandinės veiklos ir renginiai.", invert:false},
    {id:"E10", d:"E", t:"Dažniau stebiu, nei įsitraukiu.", invert:true},
    {id:"E11", d:"E", t:"Balsas ir kūno kalba pas mane ryški.", invert:false},
    {id:"E12", d:"E", t:"Vengiu skambučių ar spontaniškų susitikimų.", invert:true},

    /* A: Sutariamumas (12) */
    {id:"A1", d:"A", t:"Lengvai įsijaučiu į kitų žmonių jausmus.", invert:false},
    {id:"A2", d:"A", t:"Dažnai ginčijuosi dėl principų.", invert:true},
    {id:"A3", d:"A", t:"Stengiuosi bendradarbiauti ir ieškoti win‑win.", invert:false},
    {id:"A4", d:"A", t:"Esu tiesmukas(-a) net kai tai žeidžia.", invert:true},
    {id:"A5", d:"A", t:"Lengvai atleidžiu ir judu toliau.", invert:false},
    {id:"A6", d:"A", t:"Kitų ketinimus vertinu su nepasitikėjimu.", invert:true},
    {id:"A7", d:"A", t:"Man svarbu kurti gerą atmosferą komandoje.", invert:false},
    {id:"A8", d:"A", t:"Kritiką reiškiu griežtai, be užuolankų.", invert:true},
    {id:"A9", d:"A", t:"Lengvai nusileidžiu smulkmenose dėl bendro tikslo.", invert:false},
    {id:"A10", d:"A", t:"Dažnai pirma galvoju apie save, o ne apie kitus.", invert:true},
    {id:"A11", d:"A", t:"Esu mandagus(-i) ir pagarbus(-i) net esant įtampai.", invert:false},
    {id:"A12", d:"A", t:"Rungtyniauju labiau nei bendradarbiauju.", invert:true},

    /* N: Neurotiškumas (12) */
    {id:"N1", d:"N", t:"Lengvai imu nerimauti dėl įvairių dalykų.", invert:false},
    {id:"N2", d:"N", t:"Išlaikau ramybę netikėtose situacijose.", invert:true},
    {id:"N3", d:"N", t:"Stresas mane greitai išmuša iš vėžių.", invert:false},
    {id:"N4", d:"N", t:"Retai pergyvenu dėl klaidų.", invert:true},
    {id:"N5", d:"N", t:"Emocijos svyruoja dažniau nei norėčiau.", invert:false},
    {id:"N6", d:"N", t:"Kritiką priimu be didelio sukrėtimo.", invert:true},
    {id:"N7", d:"N", t:"Kartais sunku atsipalaiduoti.", invert:false},
    {id:"N8", d:"N", t:"Miegas ir apetitas beveik visada stabilūs.", invert:true},
    {id:"N9", d:"N", t:"Dažnai „pergalvoju“ praeitus įvykius.", invert:false},
    {id:"N10", d:"N", t:"Retai jaučiu įtampą ar nerimą.", invert:true},
    {id:"N11", d:"N", t:"Staigūs pokyčiai mane įaudrina.", invert:false},
    {id:"N12", d:"N", t:"Išlieku stabilus(-i), kai kiti jaudinasi.", invert:true}
  ];

  /* Tipų vektoriai (O,C,E,A,N) normalizuotoje skalėje –1..+1 */
  const TYPES = [
    { name:"Dirigentė",  v:{O: 0.3, C: 0.7, E: 0.5, A:-0.1, N:-0.4} },
    { name:"Strategas",   v:{O: 0.6, C: 0.8, E: 0.0, A: 0.2, N:-0.3} },
    { name:"Tyrinėtojas", v:{O: 0.9, C: 0.1, E: 0.1, A: 0.2, N: 0.0} },
    { name:"Diplomatas",  v:{O: 0.4, C: 0.5, E: 0.2, A: 0.8, N:-0.2} },
    { name:"Iniciatorius",v:{O: 0.5, C: 0.4, E: 0.8, A: 0.1, N: 0.1} },
    { name:"Analitikas",  v:{O: 0.7, C: 0.7, E:-0.2, A: 0.0, N:-0.2} },
    { name:"Rėmėjas",     v:{O: 0.2, C: 0.6, E: 0.3, A: 0.9, N:-0.4} },
    { name:"Novatorius",  v:{O: 0.8, C: 0.3, E: 0.5, A:-0.1, N: 0.0} }
  ];

  const RECS = {
    O: [
      "Kiekvieną savaitę išbandyk 1 naują metodą/įrankį ir užrašyk 3 įžvalgas.",
      "Planuok 2 val. „mokymosi langą“ – kursas, straipsniai, praktika.",
      "Peržiūrėk 1 procesą ir pasiūlyk mažą eksperimentą (A/B)."
    ],
    C: [
      "Naudok 2‑min taisyklę: jei užduotis <2 min – atlik dabar.",
      "Dienos TOP‑3: ryte užrašyk 3 svarbiausias užduotis ir pažymėk terminus.",
      "Savaitinis „uždarymo“ ritualas: sutvarkyk sąrašus, stalčių, kalendorių."
    ],
    E: [
      "Kiekvieną dieną pradėk 1 trumpą pokalbį (👋, klausimas, padėka).",
      "Kartą per savaitę vesk mini‑susitikimą arba pasidalink įžvalga komandoje.",
      "Praktikuok „atvirą pozą“: akis‑akis, nugarą tiesiai, aiškus balsas."
    ],
    A: [
      "Įdiek „veidrodžio“ principą: pirmiausia perfrazuok, ką išgirdai.",
      "Konfliktuose ieškok 1 bendro intereso ir 1 mažo kompromiso.",
      "Duok 1 nuoširdų komplimentą ar padėką kasdien."
    ],
    N: [
      "3‑3‑3 nerimo pratimas: 3 dalykai matomi, 3 girdimi, 3 jaučiami.",
      "Įsivesk „buferį“: 10 min. tarp susitikimų kvėpavimui ar pasivaikščiojimui.",
      "Vakare surašyk 3 tikslus rytdienai – mažina galvos „sukimą“."
    ]
  };

  /* ====== 2) Pagalbinės ====== */
  const by = (sel, root=document) => root.querySelector(sel);
  const el = (tag, attrs={}, ...children) => {
    const n = document.createElement(tag);
    for (const [k,v] of Object.entries(attrs)){
      if (k === "class") n.className = v;
      else if (k === "html") n.innerHTML = v;
      else if (k.startsWith("on")) n.addEventListener(k.substring(2), v);
      else n.setAttribute(k, v);
    }
    for (const c of children){
      if (typeof c === "string") n.appendChild(document.createTextNode(c));
      else if (c) n.appendChild(c);
    }
    return n;
  };

  function normFromAvg(avg15){ return (avg15 - 3) / 2; }        // -> [-1..+1]
  function pctFromAvg(avg15){ return ((avg15 - 1) / 4) * 100; } // -> [0..100]
  function fmt(n, d=2){ return Number(n).toFixed(d); }
  function mean(arr){ return arr.reduce((a,b)=>a+b,0) / (arr.length||1); }

  function cosineSim(a, b){
    const ks = ["O","C","E","A","N"];
    let dot=0, na=0, nb=0;
    for (const k of ks){ dot += a[k]*b[k]; na += a[k]*a[k]; nb += b[k]*b[k]; }
    return (na===0 || nb===0) ? 0 : dot / Math.sqrt(na*nb);
  }

  /* ====== 3) UI generavimas ====== */
  function renderItems(){
    const host = by("#itemsHost");
    host.innerHTML = "";
    const groups = {O:[],C:[],E:[],A:[],N:[]};
    for (const it of ITEMS) groups[it.d].push(it);

    for (const code of ["O","C","E","A","N"]){
      const card = el("div",{class:"card"});
      card.appendChild(el("h3",{},
        el("span",{class:`domain-tag ${code}`}, code), " ", DOMAINS[code].name
      ));
      for (const it of groups[code]){
        const itemNode = el("div",{class:"item", id:`item-${it.id}`},
          el("div",{}, el("span",{class:"pill"}, it.id), " ", it.t, " ",
            it.invert ? el("span",{class:"inline-note"},"(invertuotas)") : null
          ),
          renderLikert(it.id)
        );
        card.appendChild(itemNode);
      }
      host.appendChild(card);
    }
  }

  function renderLikert(id){
    const scale = el("div",{class:"scale", role:"radiogroup","aria-labelledby":id});
    const labels = {
      1:"Visiškai nesutinku", 2:"Nesutinku", 3:"Neutrali(-us)", 4:"Sutinku", 5:"Visiškai sutinku"
    };
    for (let v=1; v<=5; v++){
      const inputId = `${id}_${v}`;
      const label = el("label",{},
        el("input",{type:"radio", name:id, id:inputId, value:String(v), onChange:updateProgress, required:true}),
        el("span",{}, String(v)),
        el("span",{class:"inline-note"}, labels[v])
      );
      scale.appendChild(label);
    }
    return scale;
  }

  /* ====== 4) Skaičiavimas ====== */
  function collectAnswers(){
    const answers = {};
    for (const it of ITEMS){
      const checked = document.querySelector(`input[name="${it.id}"]:checked`);
      answers[it.id] = checked ? Number(checked.value) : null;
    }
    return answers;
  }

  function invertIfNeeded(value, invert){ return invert ? (value==null?null : 6 - value) : value; }

  function calcScores(){
    const ans = collectAnswers();
    const byDomain = {O:[], C:[], E:[], A:[], N:[]};
    let totalAnswered = 0;
    ITEMS.forEach(it=>{
      const v = ans[it.id];
      const use = invertIfNeeded(v, it.invert);
      if (use!=null){ byDomain[it.d].push(use); totalAnswered++; }
    });
    const out = {};
    for (const d of Object.keys(byDomain)){
      const arr = byDomain[d];
      const avg = arr.length ? mean(arr) : null;
      const norm = (avg==null) ? null : normFromAvg(avg);
      const pct = (avg==null) ? null : pctFromAvg(avg);
      out[d] = {avg, norm, pct, count: arr.length};
    }
    return {scores: out, answered: totalAnswered, total: ITEMS.length};
  }

  function renderResults(model){
    const {scores} = model;

    // Lentelė
    const tbody = by("#resTable tbody");
    tbody.innerHTML = "";
    const order = ["O","C","E","A","N"];
    for (const d of order){
      const s = scores[d];
      const tr = el("tr",{},
        el("td",{}, el("span",{class:`domain-tag ${d}`}, d), " ", DOMAINS[d].name),
        el("td",{class:"mono"}, s.avg==null ? "–" : fmt(s.avg,2)),
        el("td",{class:"mono"}, s.norm==null? "–" : (s.norm>=0?"+":"") + fmt(s.norm,2)),
        el("td",{class:"mono"}, s.pct==null ? "–" : fmt(s.pct,0) + "%")
      );
      tbody.appendChild(tr);
    }

    // TOP‑3 stiprybės ir augimo sritys
    const arr = order.map(d => ({d, ...scores[d]})).filter(x=>x.pct!=null);
    arr.sort((a,b)=>b.pct-a.pct);
    const strengths = arr.slice(0,3);
    const growth = arr.slice(-3).reverse();

    const sBox = by("#strengths"); sBox.innerHTML = "";
    strengths.forEach(x=>{
      const n = el("div",{},
        el("span",{class:`domain-tag ${x.d}`}, x.d),
        " ", DOMAINS[x.d].name, " · ",
        el("strong",{}, fmt(x.pct,0)+"%")
      );
      sBox.appendChild(n);
    });

    const gBox = by("#growth"); gBox.innerHTML = "";
    growth.forEach(x=>{
      const card = el("div",{class:`item ${x.pct<40?'danger': (x.pct<60?'': 'ok')}`},
        el("div",{}, el("span",{class:`domain-tag ${x.d}`}, x.d), " ", DOMAINS[x.d].name, " · ",
          el("strong",{}, fmt(x.pct,0)+"%")
        ),
        el("ul",{}, ...RECS[x.d].map(r => el("li",{}, r)))
      );
      gBox.appendChild(card);
    });

    // Tipų artimumas (kosinusinis panašumas)
    const self = {};
    for (const d of order){ self[d] = scores[d].norm ?? 0; }
    const typed = TYPES.map(t => {
      const sim = cosineSim(self, t.v);              // [-1..+1]
      const pct = Math.round(((sim + 1)/2) * 100);   // 0..100
      return {name:t.name, sim, pct};
    }).sort((a,b)=>b.sim - a.sim).slice(0,3);

    const tBox = by("#typesTop"); tBox.innerHTML = "";
    typed.forEach(t=>{
      tBox.appendChild(el("div",{}, el("span",{class:"pill"}, t.name), " · artimumas ",
        el("strong",{}, t.pct+"%")
      ));
    });
  }

  /* ====== 5) Veiksmai / UX ====== */
  function onCalculate(){
    const model = calcScores();
    if (model.answered < model.total){
      const remain = model.total - model.answered;
      by("#fillAllNote").textContent = `Užpildykite visus teiginius. Trūksta: ${remain}.`;
      by("#fillAllNote").classList.remove("muted");
      window.location.hash = "#teiginiai";
      setTimeout(()=>window.scrollTo({top: by("#teiginiai").offsetTop - 60, behavior:"smooth"}), 50);
      highlightMissing();
      return;
    }
    by("#fillAllNote").textContent = "Rezultatai apskaičiuoti.";
    by("#fillAllNote").classList.add("muted");
    renderResults(model);
    saveToStorage();
    window.location.hash = "#results";
    setTimeout(()=>window.scrollTo({top: by("#results").offsetTop - 60, behavior:"smooth"}), 50);
  }

  function onClear(){
    localStorage.removeItem("divirgent_ocean_answers");
    for (const it of ITEMS){
      const checked = document.querySelector(`input[name="${it.id}"]:checked`);
      if (checked) checked.checked = false;
    }
    document.querySelectorAll(".item.danger").forEach(n=>n.classList.remove("danger"));
    document.querySelectorAll(".item.ok").forEach(n=>n.classList.remove("ok"));
    by("#resTable tbody").innerHTML = "";
    by("#strengths").innerHTML = "";
    by("#growth").innerHTML = "";
    by("#typesTop").innerHTML = "";
    by("#fillAllNote").textContent = "Užpildykite visus teiginius ir paspauskite „Gauti rezultatą“.";
    by("#fillAllNote").classList.add("muted");
    updateProgress();
    window.location.hash="";
  }

  function updateProgress(){
    const model = calcScores();
    const pct = Math.round((model.answered / model.total) * 100);
    const bar = by("#progressBar");
    if (bar) bar.style.width = pct + "%";
  }

  function highlightMissing(){
    for (const it of ITEMS){
      const answered = !!document.querySelector(`input[name="${it.id}"]:checked`);
      const node = by(`#item-${it.id}`);
      if (node){
        node.style.borderColor = answered ? "var(--line)" : "#7f1d1d";
      }
    }
    updateProgress();
  }

  /* ====== 6) Saugojimas localStorage ====== */
  function saveToStorage(){
    const ans = collectAnswers();
    localStorage.setItem("divirgent_ocean_answers", JSON.stringify(ans));
  }
  function restoreFromStorage(){
    try{
      const raw = localStorage.getItem("divirgent_ocean_answers");
      if (!raw) return;
      const ans = JSON.parse(raw);
      for (const [id, val] of Object.entries(ans || {})){
        if (val==null) continue;
        const input = document.querySelector(`input[name="${id}"][value="${val}"]`);
        if (input) input.checked = true;
      }
    }catch(e){}
  }

  /* ====== 7) Startas ====== */
  function boot(){
    renderItems();
    restoreFromStorage();
    updateProgress();
    document.getElementById("calcBtn").addEventListener("click", onCalculate);
    document.getElementById("clearBtn").addEventListener("click", onClear);
  }
  document.addEventListener("DOMContentLoaded", boot);
  </script>
</body>
</html>
